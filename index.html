<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>xMan by YataoZhang</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">xMan</h1>
      <h2 class="project-tagline">一个通用的跨域解决方案(a general cross domain solution)</h2>
      <a href="https://github.com/YataoZhang/xMan" class="btn">View on GitHub</a>
      <a href="https://github.com/YataoZhang/xMan/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/YataoZhang/xMan/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="xman" class="anchor" href="#xman" aria-hidden="true"><span class="octicon octicon-link"></span></a>xMan</h1>

<h2>
<a id="xman中文文档" class="anchor" href="#xman%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3" aria-hidden="true"><span class="octicon octicon-link"></span></a>xMan中文文档</h2>

<p><em>一个通用的跨域解决方案</em></p>

<p><code>xMan</code>是一个高效的,轻量,易用(整个类库加上扩展方法一共只有10个API),兼容性很强的的跨域帮助库.支持ie6+以上以及所有主流的高级浏览器,提供get和post方法两种跨域方式.<br>
使用<code>xMan</code>可以让你的代码实现无缝跨域逻辑的实现.<code>xMan</code>竭尽所能的提供各种方法并尽力精简了以下的跨域方法,以便可以让开发者更好的进行跨域操作.</p>

<p>你可以在遵守 MIT Licence 的前提下随意使用并分发它。<code>xMan</code> 代码完全开源并托管在 Github 上。</p>

<h3>
<a id="xman的引入" class="anchor" href="#xman%E7%9A%84%E5%BC%95%E5%85%A5" aria-hidden="true"><span class="octicon octicon-link"></span></a>xMan的引入</h3>

<div class="highlight highlight-text-html-basic"><pre>
<span class="pl-s1">  &lt;<span class="pl-ent">script</span> <span class="pl-e">type</span>=<span class="pl-s"><span class="pl-pds">"</span>text/javascript<span class="pl-pds">"</span></span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">"</span>./XMan.js<span class="pl-pds">"</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</span>
</pre></div>

<h3>
<a id="xman如何向外暴露兼容amd和cmd" class="anchor" href="#xman%E5%A6%82%E4%BD%95%E5%90%91%E5%A4%96%E6%9A%B4%E9%9C%B2%E5%85%BC%E5%AE%B9amd%E5%92%8Ccmd" aria-hidden="true"><span class="octicon octicon-link"></span></a>xMan如何向外暴露(兼容AMD和CMD)</h3>

<p>xMan在生成是先行检测并依附于全局环境中的<code>exports</code>和<code>module</code>,如果没有的该属性则再次检索依附于<code>define</code>和<code>define.amd</code>,如果上述两种情况都不存在便依附于<code>window</code>.依顺序逐个依附.</p>

<div class="highlight highlight-source-js"><pre>
<span class="pl-c">// 以下为判断逻辑。需要更改的话，请下载之后在此处修改依附逻辑。</span>
  <span class="pl-k">if</span> (<span class="pl-s"><span class="pl-pds">"</span>object<span class="pl-pds">"</span></span> <span class="pl-k">==</span> <span class="pl-k">typeof</span> <span class="pl-c1">exports</span> <span class="pl-k">&amp;&amp;</span> <span class="pl-s"><span class="pl-pds">"</span>undefined<span class="pl-pds">"</span></span> <span class="pl-k">!=</span> <span class="pl-k">typeof</span> <span class="pl-c1">module</span>) {
      <span class="pl-smi">module</span>.<span class="pl-smi">exports</span> <span class="pl-k">=</span> <span class="pl-en">entrance</span>();
  } <span class="pl-k">else</span> <span class="pl-k">if</span> (<span class="pl-s"><span class="pl-pds">"</span>function<span class="pl-pds">"</span></span> <span class="pl-k">==</span> <span class="pl-k">typeof</span> define <span class="pl-k">&amp;&amp;</span> <span class="pl-smi">define</span>.<span class="pl-smi">amd</span>) {
      <span class="pl-en">define</span>([], <span class="pl-en">entrance</span>());
  } <span class="pl-k">else</span> {
      <span class="pl-k">var</span> platform;
      <span class="pl-k">if</span> (<span class="pl-s"><span class="pl-pds">"</span>undefined<span class="pl-pds">"</span></span> <span class="pl-k">!=</span> <span class="pl-k">typeof</span> <span class="pl-c1">window</span>) {
          platform <span class="pl-k">=</span> <span class="pl-c1">window</span>
      } <span class="pl-k">else</span> {
           <span class="pl-s"><span class="pl-pds">"</span>undefined<span class="pl-pds">"</span></span> <span class="pl-k">!=</span> <span class="pl-k">typeof</span> <span class="pl-c1">global</span> <span class="pl-k">?</span> platform <span class="pl-k">=</span> global <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>undefined<span class="pl-pds">"</span></span> <span class="pl-k">!=</span> <span class="pl-k">typeof</span> self <span class="pl-k">&amp;&amp;</span> (platform <span class="pl-k">=</span> self)
      }
       <span class="pl-smi">platform</span>.<span class="pl-c1">x</span> <span class="pl-k">=</span> <span class="pl-en">entrance</span>()
  }
</pre></div>

<h3>
<a id="xman如何使用" class="anchor" href="#xman%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8" aria-hidden="true"><span class="octicon octicon-link"></span></a>xMan如何使用</h3>

<p>该类库提供的方法皆为异步方法.使用时可直接用x.方法名(parma[...]).使用该方法.如下:</p>

<div class="highlight highlight-source-js"><pre>
  <span class="pl-c">// 本事例仅做演示.</span>

  <span class="pl-smi">x</span>.<span class="pl-en">jsonp</span>(<span class="pl-s"><span class="pl-pds">'</span>http://localhost:3000/jsonp<span class="pl-pds">'</span></span>, {type<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>jsonp<span class="pl-pds">'</span></span>}, <span class="pl-s"><span class="pl-pds">'</span>cb<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-smi">data</span>) {
      <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>[LOG] type:jsonp,data: <span class="pl-pds">'</span></span> <span class="pl-k">+</span> <span class="pl-smi">JSON</span>.<span class="pl-en">stringify</span>(data));
  });

  <span class="pl-smi">x</span>.<span class="pl-en">crossDomain</span>(<span class="pl-s"><span class="pl-pds">'</span>post<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>http://localhost:3000/cors<span class="pl-pds">'</span></span>, {type<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>cors<span class="pl-pds">'</span></span>}, <span class="pl-k">function</span> (<span class="pl-smi">data</span>) {
      <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>[LOG] type:cors,data: <span class="pl-pds">'</span></span> <span class="pl-k">+</span> <span class="pl-smi">JSON</span>.<span class="pl-en">stringify</span>(data));
  });

  <span class="pl-smi">x</span>.<span class="pl-en">formRequest</span>(<span class="pl-s"><span class="pl-pds">'</span>post<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>http://localhost:3000/form<span class="pl-pds">'</span></span>, {type<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>form<span class="pl-pds">'</span></span>}, <span class="pl-k">function</span> (<span class="pl-smi">data</span>) {
      <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>[LOG] type:form,data: <span class="pl-pds">'</span></span> <span class="pl-k">+</span> <span class="pl-smi">JSON</span>.<span class="pl-en">stringify</span>(data));
  });

  <span class="pl-k">var</span> outer <span class="pl-k">=</span> <span class="pl-smi">x</span>.<span class="pl-c1">frame</span>(<span class="pl-smi">window</span>.<span class="pl-c1">frames</span>[<span class="pl-c1">0</span>]);

  <span class="pl-smi">outer</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>triggerOuter<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-smi">data</span>) {
      <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>[LOG triggerOuter] type:frames,data: <span class="pl-pds">'</span></span> <span class="pl-k">+</span> <span class="pl-smi">JSON</span>.<span class="pl-en">stringify</span>(data))
  });

  <span class="pl-smi">outer</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>Message<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-smi">data</span>) {
      <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>[LOG Message Outer] type:frames,data: <span class="pl-pds">'</span></span> <span class="pl-k">+</span> <span class="pl-smi">JSON</span>.<span class="pl-en">stringify</span>(data))
  });

  <span class="pl-smi">outer</span>.<span class="pl-en">emit</span>(<span class="pl-s"><span class="pl-pds">'</span>triggerInner<span class="pl-pds">'</span></span>, {from<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>outer<span class="pl-pds">'</span></span>});

  <span class="pl-smi">outer</span>.<span class="pl-c1">send</span>(<span class="pl-s"><span class="pl-pds">'</span>this msg from outer<span class="pl-pds">'</span></span>);
</pre></div>

<h3>
<a id="xman都有哪些方法" class="anchor" href="#xman%E9%83%BD%E6%9C%89%E5%93%AA%E4%BA%9B%E6%96%B9%E6%B3%95" aria-hidden="true"><span class="octicon octicon-link"></span></a>xMan都有哪些方法</h3>

<p><em>xMan提供4种请求类型的方法，其中包括<code>jsonp</code>、<code>corssDoamin</code>、<code>formrequest</code>以及<code>frame</code>。其中前三种是用于前端与后端进行跨域交互时使用。最后一种frame则是在不同域名的frame窗口之间交互时使用，与服务器不做任何交互，仅仅只是前端不同域名的iframe之间使用。</em></p>

<h4>
<a id="1-jsonpurl-data-jsonpname-callback" class="anchor" href="#1-jsonpurl-data-jsonpname-callback" aria-hidden="true"><span class="octicon octicon-link"></span></a>1) jsonp(url, data, jsonpName, callback);</h4>

<p>此方法提供是jsonp功能.</p>

<p><code>参数列表:</code></p>

<blockquote>
<ul>
<li>
<a href="https://github.com/param" class="user-mention">@param</a> url         {string} 请求路径</li>
<li>
<a href="https://github.com/param" class="user-mention">@param</a> data        {string | object} 发送数据</li>
<li>
<a href="https://github.com/param" class="user-mention">@param</a> jsonpName   {string} 回调函数名称</li>
<li>
<a href="https://github.com/param" class="user-mention">@param</a> callback    {function} 回调函数</li>
</ul>
</blockquote>

<p><code>示例用法:</code></p>

<div class="highlight highlight-source-js"><pre>
 <span class="pl-smi">x</span>.<span class="pl-en">jsonp</span>(<span class="pl-s"><span class="pl-pds">'</span>http://localhost:3000/jsonp<span class="pl-pds">'</span></span>, {type<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>jsonp<span class="pl-pds">'</span></span>}, <span class="pl-s"><span class="pl-pds">'</span>cb<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-smi">data</span>) {
     <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>[LOG] type:jsonp,data: <span class="pl-pds">'</span></span> <span class="pl-k">+</span> <span class="pl-smi">JSON</span>.<span class="pl-en">stringify</span>(data));
 });
</pre></div>

<p><code>注意:</code><br>
1: 此方法只能为<code>GET</code>方法.<br>
2: 此方法请求数据有大小限制.(chrome为8k,firefox为7k,ie为2k)<br>
3: 此方法的兼容性为IE6+以及所有主流浏览器.<br></p>

<h4>
<a id="2-crossdomaintype-url-data-callback-settings" class="anchor" href="#2-crossdomaintype-url-data-callback-settings" aria-hidden="true"><span class="octicon octicon-link"></span></a>2) crossDomain(type, url, data, callback, settings);</h4>

<p>此方法提供的是跨域资源共享功能(切记:此方法需要server端紧密配合).</p>

<p><code>参数列表:</code></p>

<blockquote>
<ul>
<li>
<a href="https://github.com/param" class="user-mention">@param</a> type         {string} 跨域方法,可以使用两种(GET | POST)</li>
<li>
<a href="https://github.com/param" class="user-mention">@param</a> url        {string} 请求路径</li>
<li>
<a href="https://github.com/param" class="user-mention">@param</a> data      {string | string} 发送数据</li>
<li>
<a href="https://github.com/param" class="user-mention">@param</a> callback    {function} 回调函数</li>
<li>
<a href="https://github.com/param" class="user-mention">@param</a> settings    {object | undefined} 配置参数列表</li>
</ul>
</blockquote>

<p><em><code>settings</code>是配置参数列表,此列表提供了两个参数[withCredentials]和[headers].其中[withCredentials]为boolean类型,true为携带用户cookie,false(默认)为不携带用户cookie.[headers]为object类型,
主要用于用户自定义头信息.这两个参数都必须服务器允许才可使用,否则会触发<code>安全错误</code>.</em></p>

<p><code>示例用法:</code></p>

<div class="highlight highlight-source-js"><pre>
 <span class="pl-c">// 前端代码</span>
 <span class="pl-c">// 服务器制定头信息为 myself:byMyself</span>
 <span class="pl-smi">x</span>.<span class="pl-en">crossDomain</span>(<span class="pl-s"><span class="pl-pds">'</span>post<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>http://localhost:3000/cors<span class="pl-pds">'</span></span>, {type<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>cors<span class="pl-pds">'</span></span>}, <span class="pl-k">function</span> (<span class="pl-smi">data</span>) {
      <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>[LOG] type:cors,data: <span class="pl-pds">'</span></span> <span class="pl-k">+</span> <span class="pl-smi">JSON</span>.<span class="pl-en">stringify</span>(data));
 },{withCredentials<span class="pl-k">:</span><span class="pl-c1">true</span>,headers{<span class="pl-s"><span class="pl-pds">'</span>myself<span class="pl-pds">'</span></span><span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">'</span>byMyself<span class="pl-pds">'</span></span>}});

 <span class="pl-c">// server代码(仅以nodejs为例)</span>
 <span class="pl-c">// 设置允许传输cookie和允许前端自定义指定头信息</span>
  <span class="pl-smi">response</span>.<span class="pl-en">writeHead</span>(<span class="pl-c1">200</span>, {<span class="pl-s"><span class="pl-pds">'</span>Access-Control-Allow-Origin<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>http://localhost:63342<span class="pl-pds">'</span></span>,<span class="pl-c">// </span>
    <span class="pl-s"><span class="pl-pds">'</span>Access-Control-Allow-Credentials<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-c1">true</span>,
    <span class="pl-s"><span class="pl-pds">'</span>Access-Control-Allow-Headers<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>myself<span class="pl-pds">'</span></span>
  <span class="pl-k">:</span>});

</pre></div>

<p><code>注意:</code><br>
1: 此方法可使用<code>GET</code>或<code>POST</code>方法.<br>
2: 此方法跨域携带cookie和使用自定义头信息必须服务器端配置响应的响应头信息.详情请见:<a href="http://www.w3.org/TR/cors">http://www.w3.org/TR/cors</a><br>
3: 此方法的兼容性为IE8+以及所有主流浏览器.<br></p>

<h4>
<a id="3-formrequesttype-url-data-callback-enctype" class="anchor" href="#3-formrequesttype-url-data-callback-enctype" aria-hidden="true"><span class="octicon octicon-link"></span></a>3) formRequest(type, url, data, callback, enctype);</h4>

<p>此方法提供的是基本跨域传输功能(切记:此方法需要server端紧密配合).</p>

<p><code>参数列表:</code></p>

<blockquote>
<ul>
<li>
<a href="https://github.com/param" class="user-mention">@param</a> type         {string} 跨域方法,可以使用两种(GET | POST)</li>
<li>
<a href="https://github.com/param" class="user-mention">@param</a> url        {string} 请求路径</li>
<li>
<a href="https://github.com/param" class="user-mention">@param</a> data      {string | string} 发送数据</li>
<li>
<a href="https://github.com/param" class="user-mention">@param</a> callback    {function} 回调函数</li>
<li>
<a href="https://github.com/param" class="user-mention">@param</a> enctype    {string} 编码格式</li>
</ul>
</blockquote>

<p><em><code>enctype</code>提供3种选择:<br>
 1:  [application/x-www-form-urlencoded] 在发送前编码所有字符（默认）;<br>
 2:  [multipart/form-data] 不对字符编码; <br>
 3:  [text/plain] 空格转换为 "+" 加号，但不对特殊字符编码;</em></p>

<p><code>示例用法:</code></p>

<div class="highlight highlight-source-js"><pre>
 <span class="pl-c">// 前端代码</span>
  <span class="pl-smi">x</span>.<span class="pl-en">formRequest</span>(<span class="pl-s"><span class="pl-pds">'</span>post<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>http://localhost:3000/form<span class="pl-pds">'</span></span>, {type<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>form<span class="pl-pds">'</span></span>}, <span class="pl-k">function</span> (<span class="pl-smi">data</span>) {
       <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>[LOG] type:form,data: <span class="pl-pds">'</span></span> <span class="pl-k">+</span> <span class="pl-smi">JSON</span>.<span class="pl-en">stringify</span>(data));
  },<span class="pl-s"><span class="pl-pds">'</span>application/x-www-form-urlencoded<span class="pl-pds">'</span></span>);

 <span class="pl-c">// server代码(仅以nodejs为例)</span>
  <span class="pl-k">var</span> content <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>server数据<span class="pl-pds">'</span></span> 
  <span class="pl-k">var</span> header <span class="pl-k">=</span> {
       <span class="pl-s"><span class="pl-pds">'</span>content-type<span class="pl-pds">'</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>text/html<span class="pl-pds">'</span></span>,
       <span class="pl-s"><span class="pl-pds">'</span>set-cookie<span class="pl-pds">'</span></span><span class="pl-k">:</span> cookie
  };
  <span class="pl-smi">response</span>.<span class="pl-en">writeHead</span>(<span class="pl-c1">200</span>, header);
  <span class="pl-smi">response</span>.<span class="pl-en">end</span>(<span class="pl-s"><span class="pl-pds">'</span>&lt;html&gt;&lt;head&gt;&lt;script&gt;window.name=<span class="pl-pds">'</span></span> 
  <span class="pl-k">+</span> <span class="pl-smi">JSON</span>.<span class="pl-en">stringify</span>(content) 
  <span class="pl-k">+</span> <span class="pl-s"><span class="pl-pds">'</span>;location.href="about:blank";&lt;/script&gt;&lt;/head&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt;<span class="pl-pds">'</span></span>);
</pre></div>

<p><code>注意:</code><br>
1: 此方法可使用<code>GET</code>或<code>POST</code>方法.<br>
2: 此方法可以默认为携带cookie<br>
3: 此方法的兼容性为IE6+以及所有主流浏览器.<br></p>

<h4>
<a id="4-frametargetwindow" class="anchor" href="#4-frametargetwindow" aria-hidden="true"><span class="octicon octicon-link"></span></a>4) frame(targetWindow);</h4>

<p>跨iframe交互使用，此方法返回的是一个frameHandle对象</p>

<p><code>参数列表:</code></p>

<blockquote>
<ul>
<li>
<a href="https://github.com/param" class="user-mention">@param</a> targetWindow   {window}  目标窗口对象</li>
</ul>
</blockquote>

<p><code>示例用法:</code></p>

<div class="highlight highlight-source-js"><pre>
 <span class="pl-c">// 外部窗口代码，假设外部窗口的URI为 http://localhost:63342</span>
  <span class="pl-k">var</span> outer <span class="pl-k">=</span> <span class="pl-smi">x</span>.<span class="pl-c1">frame</span>(<span class="pl-smi">window</span>.<span class="pl-c1">frames</span>[<span class="pl-c1">0</span>]);
  <span class="pl-smi">outer</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>triggerOuter<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-smi">data</span>) {
      <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>[LOG triggerOuter] type:frames,data: <span class="pl-pds">'</span></span> <span class="pl-k">+</span> <span class="pl-smi">JSON</span>.<span class="pl-en">stringify</span>(data))
  });
  <span class="pl-c">//⚠注意：Message事件为内置事件，接受对方通过send方法发过来的消息对象必须通过注册该事件才可收到。</span>
  <span class="pl-smi">outer</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>Message<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-smi">data</span>) {
      <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>[LOG Message Outer] type:frames,data: <span class="pl-pds">'</span></span> <span class="pl-k">+</span> <span class="pl-smi">JSON</span>.<span class="pl-en">stringify</span>(data))
  });
  <span class="pl-c1">setTimeout</span>(<span class="pl-k">function</span> () {
      <span class="pl-smi">outer</span>.<span class="pl-en">emit</span>(<span class="pl-s"><span class="pl-pds">'</span>triggerInner<span class="pl-pds">'</span></span>, {from<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>outer<span class="pl-pds">'</span></span>});
      <span class="pl-smi">outer</span>.<span class="pl-c1">send</span>(<span class="pl-s"><span class="pl-pds">'</span>this msg from outer<span class="pl-pds">'</span></span>);
  }, <span class="pl-c1">500</span>);

 <span class="pl-c">// 内部窗口代码，假设内部窗口的URI为 http://localhost:3000</span>
   <span class="pl-k">var</span> inner <span class="pl-k">=</span> <span class="pl-smi">x</span>.<span class="pl-c1">frame</span>(<span class="pl-smi">window</span>.<span class="pl-c1">parent</span>);
  <span class="pl-smi">inner</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>triggerInner<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-smi">data</span>) {
      <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>[LOG triggerInner] type:frames,data: <span class="pl-pds">'</span></span> <span class="pl-k">+</span> <span class="pl-smi">JSON</span>.<span class="pl-en">stringify</span>(data))
  });
  <span class="pl-c">//⚠注意：Message事件为内置事件，接受对方通过send方法发过来的消息对象必须通过注册该事件才可收到。</span>
  <span class="pl-smi">inner</span>.<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>Message<span class="pl-pds">'</span></span>,<span class="pl-k">function</span>(<span class="pl-smi">data</span>){
      <span class="pl-en">console</span>.<span class="pl-c1">log</span>(<span class="pl-s"><span class="pl-pds">'</span>[LOG Message Inner] type:frames,data: <span class="pl-pds">'</span></span> <span class="pl-k">+</span> <span class="pl-smi">JSON</span>.<span class="pl-en">stringify</span>(data))
  });

  <span class="pl-c1">setTimeout</span>(<span class="pl-k">function</span>(){
      <span class="pl-smi">inner</span>.<span class="pl-en">emit</span>(<span class="pl-s"><span class="pl-pds">'</span>triggerOuter<span class="pl-pds">'</span></span>, {from<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>inner<span class="pl-pds">'</span></span>});
      <span class="pl-smi">inner</span>.<span class="pl-c1">send</span>(<span class="pl-s"><span class="pl-pds">'</span>this msg from inner<span class="pl-pds">'</span></span>);
  },<span class="pl-c1">1000</span>);
</pre></div>

<p><code>注意:</code><br>
1: 此方法仅用于不同域名iframe之间交互使用，不会与服务器进行任何交互。.<br></p>

<h4>
<a id="framehandle对象" class="anchor" href="#framehandle%E5%AF%B9%E8%B1%A1" aria-hidden="true"><span class="octicon octicon-link"></span></a>frameHandle对象</h4>

<p>frameHandle对象为x.frame(param...); 方法的返回值。操作ifarme之间的消息通讯必须通过此对象才可实现。<br>
<em>frameHandle对象只有4个实例方法，没有静态方法。</em></p>

<h6>
<a id="oneventname-callback" class="anchor" href="#oneventname-callback" aria-hidden="true"><span class="octicon octicon-link"></span></a>on(eventName, callback);</h6>

<p>注册回调事件，以供目标window对象调用。</p>

<p><code>参数列表:</code></p>

<blockquote>
<ul>
<li>
<a href="https://github.com/param" class="user-mention">@param</a> eventName      {string} 方法名称</li>
<li>
<a href="https://github.com/param" class="user-mention">@param</a> callback     {function} 回调函数</li>
</ul>
</blockquote>

<h6>
<a id="emiteventname-param" class="anchor" href="#emiteventname-param" aria-hidden="true"><span class="octicon octicon-link"></span></a>emit(eventName, param);</h6>

<p>触发对方的回调事件。</p>

<p><code>参数列表:</code></p>

<blockquote>
<ul>
<li>
<a href="https://github.com/param" class="user-mention">@param</a> eventName      {string} 需要触发的方法名称</li>
<li>
<a href="https://github.com/param" class="user-mention">@param</a> param     {object|string} 参数</li>
</ul>
</blockquote>

<h6>
<a id="sendmessage" class="anchor" href="#sendmessage" aria-hidden="true"><span class="octicon octicon-link"></span></a>send(message);</h6>

<p>向对方发送消息。对方必须通过on方法注册<code>Message</code>事件才可收到通过此方法发送的消息。</p>

<p><code>参数列表:</code></p>

<blockquote>
<ul>
<li>
<a href="https://github.com/param" class="user-mention">@param</a> message      {string} 消息内容</li>
</ul>
</blockquote>

<h6>
<a id="fireeventname-param1param2" class="anchor" href="#fireeventname-param1param2" aria-hidden="true"><span class="octicon octicon-link"></span></a>fire(eventName, [param1,param2...]]);</h6>

<p>触发本窗口注册的事件。</p>

<p><code>参数列表:</code></p>

<blockquote>
<ul>
<li>
<a href="https://github.com/param" class="user-mention">@param</a> eventName      {string} 方法名称</li>
<li>
<a href="https://github.com/param" class="user-mention">@param</a> [param1,param2...]]     {array} 参数列表</li>
</ul>
</blockquote>

<h2>
<a id="疑问" class="anchor" href="#%E7%96%91%E9%97%AE" aria-hidden="true"><span class="octicon octicon-link"></span></a>疑问?</h2>

<p>如果您有任何疑问，请随时提出通过 <a href="https://github.com/YataoZhang/xMan/issues/new">New Issue</a>.</p>

<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span class="octicon octicon-link"></span></a>License</h2>

<p>xMan.js在MIT的条款下提供 <a href="https://github.com/YataoZhang/xMan/blob/master/LICENSE">MIT License</a>.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/YataoZhang/xMan">xMan</a> is maintained by <a href="https://github.com/YataoZhang">YataoZhang</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
